{% extends mobile.html %}

{# Games Header #}
{% block content_header %}
    {% module ContentHeaderView(games.context_container) %}
{% end %}

{# Games Content #}
{% block page_content %}
    
    {# Games Row Fields - Secondary #}
    {% set name_tag = {
            TEMPLATE.START_TAG: "<span class=\"content-title\">", 
            TEMPLATE.DISPLAY_PROPERTY: "name", 
            TEMPLATE.END_TAG: "</span>"} %}
    {% set score_tag = {
            TEMPLATE.START_TAG: "<strong>", 
            TEMPLATE.DISPLAY_PROPERTY: "score", 
            TEMPLATE.END_TAG: "</strong>"} %}

    {# Modify Outcomes for proper display #}
    {% set outcomes = games.get_outcomes_by_game() %}
    {# add opponent's name to result #}
    {% for outcome in outcomes.values() %}
        {% for result in outcome %}
            {% set result.name = result.opponent.name %}
        {% end %}
    {% end %}

    {# Games Row Creation #}
    {% set games_fields = [name_tag, score_tag] %}

    {# ListView #}
    {# FIXME set sort_field to some representation of created_ts #}
    {% module ListView(
        games.games, 
        {},
        "",
        outcomes, 
        games_fields) %}

{% end %}

